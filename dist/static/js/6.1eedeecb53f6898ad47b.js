webpackJsonp([6],{"7wFW":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("QAqB");var r=a("lrFM"),s=(a("Bs21"),a("hrok"),a("CFbC"),a("Q6dk"),a("ada0")),n=a("M9A7"),o=a("vMJZ"),i=(a("iNxE"),a("viA7"),{name:"userboard",data:function(){return{userInfo:{},name:"",contact:"",graduate:"",email:"",avatarUrl:"",BlogInfo:{},articles:[],fileList:[],perpage:5,pageint:1,userID:-1,filekey:1,baseurl:""}},watch:{avatarUrl:function(e,t){console.log("avatarUrl")}},created:function(){this.userInfo=this.$route.params.userInfo,this.name=this.$store.state.name,this.contact=this.$store.state.contact,this.graduate=this.$store.state.graduate,this.email=this.$store.state.email;var e=(new Date).getTime();this.avatarUrl="http://10.129.167.54:8079"+this.$store.state.avatarUrl+"?id="+e,this.baseurl=this.$store.state.avatarUrl,this.userID=this.$store.state.id,this.getBlogInfo(),this.getUserBlog()},methods:{getBlogInfo:function(){var e=this;Object(o.c)(e.userID).then(function(t){e.BlogInfo=t.content,e.userInfo=e.BlogInfo.blogger}).catch(function(t){"error"!==t&&e.$message({type:"error",message:"用户信息加载失败!",showClose:!0})}),console.log(e.BlogInfo)},getUserBlog:function(){var e=this;Object(o.d)(e.userID,e.pageint,e.perpage).then(function(t){0==t.code?e.articles=t.content:e.$message({type:"error",message:t.reason,showClose:!0})}).catch(function(t){"error"!==t&&e.$message({type:"error",message:"文章加载失败!",showClose:!0})})},handleSizeChange:function(e){this.perpage=e,console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.pageint=e,this.getUserBlog(),console.log("当前页: "+e)},uploadavatar:function(e){var t=new FormData;t.append("file",e.file);var a=this;Object(o.g)(t,a.userID).then(function(e){if(0===e.code){var t=e.content,r=(new Date).getTime();a.avatarUrl="http://10.129.167.54:8079"+t+"?id="+r,a.baseurl=t,a.filekey=Math.random();var s={id:a.userID,name:a.name,avatarUrl:t,contact:a.contact,email:a.email,graduate:a.graduate};a.$store.dispatch("updateUserInfo",s).then(function(){}).catch(function(e){"error"!==e&&a.$message({message:e,type:"error",showClose:!0})})}else a.$message({type:"error",message:e.reason,showClose:!0})}).catch(function(e){console.error(e),"error"!==e&&a.$message({type:"error",message:"头像上传失败!",showClose:!0})})},handleAvatarSuccess:function(e,t){},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},updateUserInfo:function(){var e=this,t={id:e.userID,name:e.name,avatarUrl:e.baseurl,contact:e.contact,email:e.email,graduate:e.graduate};Object(n.e)(e.userID,t).then(function(a){console.log("modify success"),e.$store.dispatch("updateUserInfo",t).then(function(){}).catch(function(t){"error"!==t&&e.$message({message:t,type:"error",showClose:!0})})}).catch(function(t){"error"!==t&&e.$message({type:"error",message:"用户信息修改失败!",showClose:!0})})}},components:{"article-item":s.a,sidebar:r.a}}),l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("sidebar"),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-row",[a("el-upload",{staticClass:"avatar-uploader",staticStyle:{"margin-top":"20%","margin-left":"30%"},attrs:{action:"","on-change":e.handleChange,"show-file-list":!1,"http-request":e.uploadavatar}},[e.avatarUrl?a("img",{key:e.filekey,staticClass:"avatar",attrs:{src:e.avatarUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-row",[a("el-upload",{staticClass:"upload-demo",staticStyle:{"margin-left":"40%","margin-top":"5%"},attrs:{action:"","on-change":e.handleChange,"show-file-list":!1,"file-list":e.fileList,"http-request":e.uploadavatar}},[a("el-button",{staticStyle:{"font-size":"100%"},attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),a("el-row",[a("div",{staticStyle:{"text-align":"center","margin-top":"5%"}}),e._v(" "),a("el-form",{ref:"form",staticStyle:{"font-size":"20px","margin-top":"10%"},attrs:{"label-width":"50%",size:"medium"}},[a("el-form-item",{staticStyle:{width:"100%",height:"20%","font-size":"20px","margin-top":"10%"},attrs:{label:"用户名称"}},[a("el-input",{attrs:{place:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%",height:"20%","margin-top":"5%"},attrs:{label:"用户邮箱"}},[a("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%",height:"20%","margin-top":"5%"},attrs:{label:"用户毕业院校"}},[a("el-input",{model:{value:e.graduate,callback:function(t){e.graduate=t},expression:"graduate"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%",height:"20%","margin-top":"5%"},attrs:{label:"用户联系方式"}},[a("el-input",{model:{value:e.contact,callback:function(t){e.contact=t},expression:"contact"}})],1)],1)],1),e._v(" "),a("el-row",[a("div",{staticStyle:{"margin-top":"5%"}},[a("el-button",{staticStyle:{"font-size":"100%","margin-left":"38%"},attrs:{type:"success",plain:""},on:{click:function(t){return e.updateUserInfo()}}},[e._v("提交修改")])],1)])],1),e._v(" "),a("el-col",[e._l(e.articles,function(e){return a("div",{key:e.id,staticStyle:{width:"90%","margin-left":"5%"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("article-item",{staticStyle:{"margin-top":"1%"},attrs:{id:e.id,title:e.title,detail:e.detail,content:e.content,blogger:e.blogger,"tags:":e.tags,permission:e.permission,visits:e.visits,likes:e.likes}})],1)],1)],1)}),e._v(" "),a("div",{staticClass:"block",staticStyle:{"margin-left":"30%",bottom:"1%",position:"absolute","background-color":"#FFEFD5"}},[a("el-pagination",{attrs:{"current-page":e.currentPage3,"page-size":e.perpage,layout:"prev, pager, next, jumper",total:e.BlogInfo.blogCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage3=t},"update:current-page":function(t){e.currentPage3=t}}})],1)],2)],1)},staticRenderFns:[]};var c=a("VU/8")(i,l,!1,function(e){a("cR6r")},"data-v-7d498b3e",null);t.default=c.exports},LOMN:function(e,t){},cR6r:function(e,t){},lrFM:function(e,t,a){"use strict";var r={name:"SideBar",props:{},data:function(){return{}},computed:{},methods:{handleOpen:function(e,t){console.log(e,t)},handleClose:function(e,t){console.log(e,t)},goUserEdit:function(){this.$router.push("/userboard")},goUserInfos:function(){this.$router.push("/userinfos")},goUserBlogs:function(){this.$router.push("/userblogs")}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-col",{attrs:{span:4}},[a("el-menu",{staticClass:"el-menu-vertical-demo",staticStyle:{"font-size":"30px",height:"100%",position:"fixed","margin-top":"0%"},attrs:{"default-active":"1","background-color":"#FFEFD5","text-color":"#696969","active-text-color":"#000000"},on:{open:e.handleOpen,close:e.handleClose}},[a("el-menu-item",{attrs:{index:"1"}},[a("i",{staticClass:"el-icon-edit"}),e._v(" "),a("span",{staticStyle:{"font-size":"20px"},attrs:{slot:"title"},on:{click:function(t){return e.goUserEdit()}},slot:"title"},[e._v("个人信息")])])],1)],1)},staticRenderFns:[]};var n=a("VU/8")(r,s,!1,function(e){a("LOMN")},null,null);t.a=n.exports}});
//# sourceMappingURL=6.1eedeecb53f6898ad47b.js.map